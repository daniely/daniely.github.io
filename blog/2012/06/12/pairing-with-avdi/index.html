
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pairing With Avdi - daniely.github.io</title>
  <meta name="author" content="Daniel Yoon">

  
  <meta name="description" content="Intro Back in 2012 Avdi Grimm was offering to pair program
for free - all you had to do was ask. Avdi no longer
offers this amazing service but I &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://daniely.github.io/blog/2012/06/12/pairing-with-avdi/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
   <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="daniely.github.io" type="application/atom+xml">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Lato:400,100,100italic,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,900' rel='stylesheet' type='text/css'>


	<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$$','$$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




  

  <style>html{background: url("/images/background.png") no-repeat center center fixed;-webkit-background-size: cover;-moz-background-size: cover;-o-background-size: cover;background-size: cover;}</style>
</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:daniely.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav> -->
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pairing With Avdi</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-12T17:54:00+08:00" pubdate data-updated="true">Jun 12<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2 id="intro">Intro</h2>

<p>Back in 2012 <a href="http://devblog.avdi.org/">Avdi Grimm</a> was offering to pair program
for free - all you had to do was ask. Avdi <a href="http://devblog.avdi.org/2013/02/19/taking-a-break-from-pair-programming/">no longer</a>
offers this amazing service but I wanted to at least share about one of our pairing
sessions as I feel very lucky to have had the opportunity.</p>

<h2 id="spree-installer-bug">Spree Installer Bug</h2>

<p>The first problem we tackled was a small bug in <a href="https://github.com/spree/spree">Spree Commerce</a>.
During installation it would sometimes incorrectly detect a successful imagemagick
installation.  I had already submitted
a <a href="https://github.com/spree/spree/pull/1533">pull request</a> but I didn’t know
how to go about writing a test for it.</p>

<p>In the end we decided not to write a real test but we did do a quick spike.
Without going into too much detail, the original
pull request runs a shell command then checks the exit code. If it runs without
errors we can assume imagemagick is correctly installed.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="c1"># shell command to check if imagemagick is installed correctly</span>
</span><span class="line"><span class="sx">%x(identify -version)</span>
</span><span class="line">
</span><span class="line"><span class="c1"># check exit code</span>
</span><span class="line"><span class="vg">$?</span> <span class="o">=&gt;</span> <span class="c1">#&lt;Process::Status: pid 16493 exit 0&gt;</span>
</span><span class="line">
</span><span class="line"><span class="c1"># better way to check</span>
</span><span class="line"><span class="vg">$?</span><span class="o">.</span><span class="n">success?</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>First thing Avdi says is, “lets see if we can override the %x command”. I just
stared at him blankly on our screenshare. Wut? How? Do we write a method like
<code>def %x(command)</code> or something? I tried, it doesn’t work. So what to do?</p>

<p>Another common way to run shell commands from ruby is to use backticks.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="sb">`pwd`</span> <span class="o">=&gt;</span> <span class="s2">&quot;/Users/daniel/code</span><span class="se">\n</span><span class="s2">&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Somehow Avdi knew that the <code>%x</code> syntax uses backticks. It’s <a href="http://ruby-doc.org/core-2.0/Kernel.html#method-i-60">documented</a>
but I was still surprised he knew this. He had a hunch that we could override
backticks and in turn override <code>%x</code> and that’s exactly what we did.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="k">class</span> <span class="nc">Foo</span>
</span><span class="line">  <span class="k">def</span> <span class="nf">`</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span class="line">    <span class="nb">puts</span> <span class="s1">&#39;hello&#39;</span>
</span><span class="line">  <span class="k">end</span>
</span><span class="line"><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>But after we wrote this bit I was stuck again. How the heck do you call that
method? <code>Foo.new`('some command')</code> ??? That wont work. The answer is to use
<code>instance_eval</code>.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">o</span> <span class="o">=</span> <span class="no">Foo</span><span class="o">.</span><span class="n">new</span>
</span><span class="line"><span class="n">o</span><span class="o">.</span><span class="n">instance_eval</span> <span class="p">{</span> <span class="sb">`ls`</span> <span class="p">}</span>
</span><span class="line"><span class="c1"># =&gt; &#39;hello&#39;</span>
</span><span class="line">
</span><span class="line"><span class="c1"># with the %x syntax</span>
</span><span class="line"><span class="n">o</span><span class="o">.</span><span class="n">instance_eval</span> <span class="p">{</span> <span class="sx">%x[ls]</span> <span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1"># exit code ok?</span>
</span><span class="line"><span class="vg">$?</span>  <span class="c1"># =&gt; 0</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The other issue was figuring out whether or not we could override the <code>$?</code>
value. But turns out it’s read only.</p>

<p>This was the point when Avdi realized that there’s no reason
to use backticks or the <code>%x[]</code> way of making system calls because these
versions are mainly used for their return values. All we want to know is if the
command executed successfully and relying on
<code>$?</code> for that info is in a way reaching outside of our methods boundaries.</p>

<p>A simpler/better approach is to call the command and see if
it was successful or not. That’s it. And we can do just that with <code>system</code>. Thus our
code refactored to this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="ruby"><span class="line"><span class="n">success</span> <span class="o">=</span> <span class="nb">system</span><span class="p">(</span><span class="s1">&#39;identify -version&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>We replaced 7 lines of code with just that one call in a new
<a href="https://github.com/spree/spree/pull/1660/files">pull request</a></p>

<h2 id="double-error-messages">Double Error Messages</h2>

<p>Then we talked about the double error messages that show up when you have a form ‘hint’
that’s the same as the error message. I was asking Avdi to help me figure out
how to “correctly” change the way rails handles this. But it turns out the
“correct” solution is to not touch rails at all. Instead, change the markup.
This was solved by adding a css style to hide the hint when an error
group is present. That’s it! simple!</p>

<h2 id="finding-solutions">Finding Solutions</h2>

<p>This was a valuable lesson I learned from Avdi. While he has the technical chops
to program his way around things that’s not what he turns to first.
Instead, he looks to see if the solution being implemented is the right fit.
Often times it’s not and there might be a simpler solution to the problem. We just
saw two examples of that.</p>

<h2 id="getting-better">Getting Better</h2>

<p>For the last part of our session I asked for advice on improving as a developer.
These are the tips he gave in no particular order:</p>

<ul>
  <li>Pair program</li>
  <li>Read code. rack is a good codebase to look at</li>
  <li>Read books. Blogs are ok but books tend to have less errors
    <ul>
      <li>Eloquent Ruby, Ruby Best Practices, The Ruby Way, Ruby Quiz,
ruby talk mailing list, anything written by James Gray,
Peepcode Play by Play</li>
    </ul>
  </li>
</ul>

<h2 id="thanks-avdi-for-the-awesome-pairing-session">Thanks Avdi for the awesome pairing session!</h2>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Daniel Yoon</span></span>

      








  


<time datetime="2012-06-12T17:54:00+08:00" pubdate data-updated="true">Jun 12<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/pair-programming/'>Pair Programming</a>, <a class='category' href='/blog/categories/ruby/'>Ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://daniely.github.io/blog/2012/06/12/pairing-with-avdi/" data-via="" data-counturl="http://daniely.github.io/blog/2012/06/12/pairing-with-avdi/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/06/08/ping-range-of-urls/" title="Previous Post: Ping Range of Urls">&laquo; Ping Range of Urls</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/09/05/using-foreman/" title="Next Post: Using Foreman">Using Foreman &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section id="titles">
  <a href="http://daniely.github.io" title="daniely.github.io"><img id="logo" src="http://daniely.github.io/images/" /></a>
  <h1 id="site_title"><a href="http://daniely.github.io" title="daniely.github.io">daniely.github.io</a></h1>
  <h3 id="site_subtitle">Learning by sharing</h3>
</section>

<section id="menu">
  <ul>
    <li><i class="fa fa-home fa-lg"></i><a href="http://daniely.github.io"> Home </a></li>
    <li><i class="fa fa-calendar fa-lg"></i><a href="http://daniely.github.io/blog/archives/"> Archives </a></li>
    <li><i class="fa fa-user fa-lg"></i><a href="http://daniely.github.io/about/"> About </a></li>
    <li><i class="fa fa-rss fa-lg"></i><a href="http://daniely.github.io/atom.xml"> Feed </a></li>
  </ul>
</section>

<section id="social">
  

  

  

  

  

  
</section>


<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/10/12/long-feature-branch-names-in-git/">Long Feature Branch Names in Git</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/05/using-foreman/">Using Foreman</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/12/pairing-with-avdi/">Pairing With Avdi</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/08/ping-range-of-urls/">Ping Range of Urls</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/03/vagrant-nfs-mount-failing-on-mac-osx/">Vagrant NFS mount failing on mac osx</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Daniel Yoon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dyblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://daniely.github.io/blog/2012/06/12/pairing-with-avdi/';
        var disqus_url = 'http://daniely.github.io/blog/2012/06/12/pairing-with-avdi/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
