
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Using Foreman - daniely.github.io</title>
  <meta name="author" content="Daniel Yoon">

  
  <meta name="description" content="Intro One of the Rails apps I’m working on depends on a lot of locally running
services - database, job queue, web services, just to name a few. When &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://daniely.github.io/blog/2013/09/05/using-foreman/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
   <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="daniely.github.io" type="application/atom+xml">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Lato:400,100,100italic,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,900' rel='stylesheet' type='text/css'>


	<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$$','$$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




  

  <style>html{background: url("/images/background.png") no-repeat center center fixed;-webkit-background-size: cover;-moz-background-size: cover;-o-background-size: cover;background-size: cover;}</style>
</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:daniely.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav> -->
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Using Foreman</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-05T20:24:00+08:00" pubdate data-updated="true">Sep 5<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2 id="intro">Intro</h2>

<p>One of the Rails apps I’m working on depends on a lot of locally running
services - database, job queue, web services, just to name a few. When I
started on the project I was opening up a new iTerm2 tab for each service
but that got old real quick. <a href="https://github.com/ddollar/foreman">Foreman</a>
is a great tool for dealing with situations like this.</p>

<p>For a basic intro to foreman <a href="http://blog.daviddollar.org/2011/05/06/introducing-foreman.html">go here</a>.</p>

<h2 id="tips">Tips</h2>

<p>Most examples of foreman show you how to run multiple processes from the
same folder but what if you need to run them from separate folders? My project
is setup like so:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class=""><span class="line">|-- project_root
</span><span class="line">    |-- website (rails)
</span><span class="line">    |-- account_services (sinatra)</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>A typical <code>Procfile</code> looks like:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">website: bundle exec rails server -p 3000</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>But my <code>Procfile</code> is in the project root and I need to run both a rails webserver
in <code>website</code> and a sinatra app in <code>account_services</code> so that wont work. You can
however do this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">website: sh -c 'cd website &amp;&amp; bundle exec rails s -p 3000'
</span><span class="line">account_services: sh -c 'cd account_services &amp;&amp; bundle exec rackup -p 3001'</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Use the <code>sh</code> command to change into the appropriate directory and run the
appropriate command to get your process running.</p>

<p>You’ll notice that I specify port 3000 even though that’s the default in rails.
The reason
is because sometimes you might end up with processes that don’t get shut down by
foreman. In those cases you can use <code>pgrep -f 3000 | xargs kill</code> to kill them off.
Specifying the port number makes it easy to find the process using <code>pgrep</code>.</p>

<h2 id="advantages">Advantages</h2>

<p>You might be wondering if it’s really worth the effort. After all, it’s just one
rails app and one sinatra app. In reality, my project has about 8
process that need to be up and running:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class=""><span class="line">1 rails app
</span><span class="line">3 sinatra services
</span><span class="line">1 database
</span><span class="line">1 caching
</span><span class="line">1 job queue
</span><span class="line">1 messaging system</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>So rather than opening up 8 different tabs and fiddling with the history to find
the right commands I just go to my project root and type <code>foreman start</code> and
everything is up and running.</p>

<p>Another advantage is that the logs show up in one terminal window. At first I
didn’t like that but it turns out to be very useful. When you have 8 different
processes outputting information it’s nice to be able to see them aggregated in
one location. Plus, if you had to search in 8 different tabs you’d also have to scroll
through each one - what a pain.</p>

<p><img class="left" src="http://new.tinygrab.com/0392f215b1cc9d858cbdc36d4b83c862f46badaa66.png" width="400" /></p>

<p>For more fine grained control you could always run the process in their own window.
That’s what I do with the rails website. I like to see the output in a separate
window and I might need to restart it when changing config files or something.</p>

<p>Anyway, if you start moving away from those monolithic rails apps and start
splitting them up into services take a look at <a href="https://github.com/ddollar/foreman">foreman</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Daniel Yoon</span></span>

      








  


<time datetime="2013-09-05T20:24:00+08:00" pubdate data-updated="true">Sep 5<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/foreman/'>Foreman</a>, <a class='category' href='/blog/categories/rails/'>Rails</a>, <a class='category' href='/blog/categories/ruby/'>Ruby</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://daniely.github.io/blog/2013/09/05/using-foreman/" data-via="" data-counturl="http://daniely.github.io/blog/2013/09/05/using-foreman/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/06/12/pairing-with-avdi/" title="Previous Post: Pairing With Avdi">&laquo; Pairing With Avdi</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/10/12/long-feature-branch-names-in-git/" title="Next Post: Long Feature Branch Names in Git">Long Feature Branch Names in Git &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section id="titles">
  <a href="http://daniely.github.io" title="daniely.github.io"><img id="logo" src="http://daniely.github.io/images/" /></a>
  <h1 id="site_title"><a href="http://daniely.github.io" title="daniely.github.io">daniely.github.io</a></h1>
  <h3 id="site_subtitle">Learning by sharing</h3>
</section>

<section id="menu">
  <ul>
    <li><i class="fa fa-home fa-lg"></i><a href="http://daniely.github.io"> Home </a></li>
    <li><i class="fa fa-calendar fa-lg"></i><a href="http://daniely.github.io/blog/archives/"> Archives </a></li>
    <li><i class="fa fa-user fa-lg"></i><a href="http://daniely.github.io/about/"> About </a></li>
    <li><i class="fa fa-rss fa-lg"></i><a href="http://daniely.github.io/atom.xml"> Feed </a></li>
  </ul>
</section>

<section id="social">
  

  

  

  

  

  
</section>


<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/10/12/long-feature-branch-names-in-git/">Long Feature Branch Names in Git</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/05/using-foreman/">Using Foreman</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/12/pairing-with-avdi/">Pairing With Avdi</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/08/ping-range-of-urls/">Ping Range of Urls</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/03/vagrant-nfs-mount-failing-on-mac-osx/">Vagrant NFS mount failing on mac osx</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Daniel Yoon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dyblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://daniely.github.io/blog/2013/09/05/using-foreman/';
        var disqus_url = 'http://daniely.github.io/blog/2013/09/05/using-foreman/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
